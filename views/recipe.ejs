<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Create new recipe</title>
    <link rel="stylesheet" href="/css/styles.css" />
    <script
      src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.6/dist/htmx.min.js"
      integrity="sha384-Akqfrbj/HpNVo8k11SXBb6TlBWmXXlYQrCSqEWmyKJe+hDm3Z/B2WVG4smwBkRVm"
      crossorigin="anonymous"
      defer
    ></script>
    <style>
      svg {
        border: 2px solid #444;
        background: #f9f9f9;
      }
      rect {
        fill: lightblue;
        stroke: #333;
        stroke-width: 2;
        cursor: move;
      }
      circle {
        fill: white;
        stroke: #333;
        stroke-width: 2;
      }
      .connection-point {
        r: 8;
        cursor: crosshair;
        fill: white;
      }
      line {
        stroke: #555;
        stroke-width: 2;
        cursor: pointer;
      }
      text {
        user-select: none;
      }
      .selected-line {
        stroke: red;
        stroke-width: 3;
      }
      .selected-box rect {
        stroke: red;
        stroke-width: 3;
      }
    </style>
  </head>
  <body>
    <div class="header">
      <h1>Create new recipe</h1>
    </div>
    <div class="create-recipe-container">
      <div>
        <div class="menu">
          <button hx-on:click="displayPanel()">Processes</button>
          <button id="saveRecipeButton">Save recipe</button>
        </div>
      </div>
      <div class="canvas-wrapper">
        <svg id="canvas" xmlns="http://www.w3.org/2000/svg">
          <g id="connections"></g>
          <g id="connection-labels"></g>
          <g id="processes"></g>
          <g id="connectors">
            <g
              id="start"
              transform="translate(50, 250)"
              xmlns="http://www.w3.org/2000/svg"
            >
              <circle
                r="30"
                cx="30"
                cy="30"
                class="connector-circle"
                xmlns="http://www.w3.org/2000/svg"
              ></circle>
              <text
                x="30"
                y="35"
                text-anchor="middle"
                class="connector-label"
                xmlns="http://www.w3.org/2000/svg"
              >
                Start
              </text>
              <circle
                hx-on:mousedown="startConnection(event)"
                r="8"
                cx="60"
                cy="30"
                data-type="output"
                class="connection-point"
                xmlns="http://www.w3.org/2000/svg"
              ></circle>
            </g>
            <g
              id="end"
              transform="translate(1400, 250)"
              xmlns="http://www.w3.org/2000/svg"
            >
              <circle
                r="30"
                cx="30"
                cy="30"
                class="connector-circle"
                xmlns="http://www.w3.org/2000/svg"
              ></circle>
              <text
                x="30"
                y="35"
                text-anchor="middle"
                class="connector-label"
                xmlns="http://www.w3.org/2000/svg"
              >
                End
              </text>
              <circle
                hx-on:mousedown="startConnection(event)"
                r="8"
                cx="0"
                cy="30"
                data-type="input"
                class="connection-point"
                xmlns="http://www.w3.org/2000/svg"
              ></circle>
            </g>
          </g>
        </svg>
      </div>
      <div id="panel" class="panel">
        <div class="panel-header">
          <h2>Add process</h2>
          <button
            hx-on:click="hidePanel()"
            class="close-button"
            aria-label="Close"
          >
            &times;
          </button>
        </div>
        <div class="panel-actions">
          <button
            hx-post="/processes"
            hx-target="#processes"
            hx-swap="beforeend"
            hx-vals='{
              "name": "New process"
            }'
            class="add-button"
            aria-label="New process"
          >
            New
          </button>
        </div>
      </div>
    </div>
    <script src="/js/create-recipe.js"></script>
  </body>
</html>
